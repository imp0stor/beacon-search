# Notion Integration Template
name: "Notion"
type: "rest"
description: "Notion workspace pages and databases"
icon: "notion"
category: "productivity"

auth:
  type: "oauth2"
  fields:
    - name: "client_id"
      label: "OAuth Client ID"
      type: "text"
      required: true
    - name: "client_secret"
      label: "OAuth Client Secret"
      type: "password"
      required: true
  oauth_urls:
    authorize: "https://api.notion.com/v1/oauth/authorize"
    token: "https://api.notion.com/v1/oauth/token"
  headers:
    Notion-Version: "2022-06-28"

endpoints:
  search:
    url: "https://api.notion.com/v1/search"
    method: "POST"
    body:
      query: "${query}"
      page_size: 100
    pagination:
      type: "cursor"
      cursor_param: "start_cursor"
      results_field: "results"
      next_field: "next_cursor"
      has_more_field: "has_more"
  
  get_page:
    url: "https://api.notion.com/v1/pages/${id}"
    method: "GET"
  
  get_blocks:
    url: "https://api.notion.com/v1/blocks/${id}/children"
    method: "GET"
    params:
      page_size: 100
    pagination:
      type: "cursor"
      cursor_param: "start_cursor"
      results_field: "results"
  
  list_databases:
    url: "https://api.notion.com/v1/search"
    method: "POST"
    body:
      filter:
        property: "object"
        value: "database"
  
  query_database:
    url: "https://api.notion.com/v1/databases/${database_id}/query"
    method: "POST"
    body:
      page_size: 100

mapping:
  page:
    id: "$.id"
    title: "$.properties.title.title[0].plain_text"
    content: ""
    url: "$.url"
    author: "$.created_by.id"
    modified: "$.last_edited_time"
    created: "$.created_time"
    document_type: "page"
    attributes:
      parent_type: "$.parent.type"
      parent_id: "$.parent.page_id || $.parent.database_id"
      archived: "$.archived"
      icon: "$.icon"
      cover: "$.cover"
  
  database:
    id: "$.id"
    title: "$.title[0].plain_text"
    url: "$.url"
    document_type: "database"

block_types:
  - paragraph
  - heading_1
  - heading_2
  - heading_3
  - bulleted_list_item
  - numbered_list_item
  - toggle
  - to_do
  - quote
  - callout
  - code
  - table
  - child_page
  - child_database

rate_limit:
  requests_per_minute: 150
  concurrent: 3

features:
  - incremental_sync
  - block_parsing
  - database_query
  - rich_text
  - inline_databases

content_types:
  - pages
  - databases
  - database_items

content_processors:
  - name: "notion_blocks_to_text"
    config:
      include_toggles: true
      include_callouts: true
      max_depth: 10

docs_url: "https://developers.notion.com/reference/intro"
